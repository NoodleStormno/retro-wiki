#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
中古游戏机急救指南 - 自动内容生成脚本
生成5篇测试文章，包含完整的Markdown排版
"""

import os
from pathlib import Path

# 定义5个测试长尾词
LONG_TAIL_KEYWORDS = [
    'PS2光头老化读盘卡顿修复',
    'GBA屏幕烧屏换偏光膜教程',
    'PSP电池锁电红灯不亮激活',
    'SFC外壳发黄去黄水漂白比例',
    'NDS转轴断裂更换外壳图文'
]

def create_article(keyword):
    """根据关键词创建文章内容"""
    
    # 根据不同的关键词生成不同的内容
    if keyword == 'PS2光头老化读盘卡顿修复':
        return f"""# {keyword}

> **故障现象**：PS2游戏机读盘困难，经常卡在Loading界面，或者游戏中途卡顿、死机，光盘转动声音异常。

## 所需工具
- 十字螺丝刀（PH00规格）
- 防静电镊子
- 无水酒精（99%纯度）
- 棉签
- 吹气球
- 防静电手套

## 维修步骤

### 1. 拆卸PS2主机
1. 断开所有电源线和连接线
2. 使用十字螺丝刀卸下底部螺丝
3. 小心打开主机外壳，注意排线连接
4. 找到光头组件位置

### 2. 清洁光头透镜
1. 用吹气球吹去光头表面的灰尘
2. 用棉签蘸取少量无水酒精
3. 轻轻擦拭光头透镜表面（单向擦拭）
4. 等待酒精完全挥发

### 3. 检查光头导轨
1. 观察光头在导轨上的移动是否顺畅
2. 如有卡顿，可在导轨上涂抹少量润滑脂
3. 手动移动光头几次确保顺畅

### 4. 调整光头功率（谨慎操作）
1. 找到光头组件上的电位器
2. 用螺丝刀微调（每次不超过15度）
3. 测试读盘效果
4. 重复调整直到最佳状态

## 配件与价格参考

| 所需配件 | 参考价格 | 购买建议 |
|---------|---------|---------|
| PS2光头组件（全新） | ¥80-120 | 淘宝/闲鱼 |
| 无水酒精（100ml） | ¥15-20 | 药店/化工商店 |
| 专用润滑脂 | ¥25-35 | 电子维修店 |
| 防静电工具套装 | ¥50-80 | 京东/天猫 |

## 注意事项
- 操作时务必佩戴防静电手套
- 酒精用量要少，避免流入内部电路
- 调整光头功率需谨慎，过度调整会烧毁光头
- 如清洁无效，建议直接更换光头组件

## 维修难度：★★★☆☆
## 预计耗时：1-2小时
"""

    elif keyword == 'GBA屏幕烧屏换偏光膜教程':
        return f"""# {keyword}

> **故障现象**：GBA屏幕出现永久性残影、颜色失真、对比度下降，在关机状态下也能看到淡淡的图像痕迹。

## 所需工具
- 三角撬棒
- 热风枪或电吹风
- 无尘布
- 偏光膜（45度角）
- 刮板
- 屏幕清洁液

## 维修步骤

### 1. 拆卸GBA外壳
1. 卸下背部6颗螺丝
2. 用三角撬棒小心分离前后壳
3. 断开屏幕排线连接
4. 取出屏幕总成

### 2. 移除旧偏光膜
1. 用热风枪低温加热屏幕边缘（80-100°C）
2. 用刮板轻轻撬起偏光膜一角
3. 缓慢均匀地撕下旧偏光膜
4. 用屏幕清洁液清理残留胶水

### 3. 粘贴新偏光膜
1. 在新偏光膜保护膜上标记45度角
2. 对齐屏幕边缘，先贴一边
3. 用刮板慢慢推平，排除气泡
4. 撕掉保护膜，检查贴合情况

### 4. 组装测试
1. 重新连接屏幕排线
2. 开机测试显示效果
3. 检查有无气泡或灰尘
4. 确认无误后组装外壳

## 配件与价格参考

| 所需配件 | 参考价格 | 购买建议 |
|---------|---------|---------|
| GBA偏光膜（45度） | ¥15-25 | 淘宝/拼多多 |
| 三角撬棒套装 | ¥20-30 | 维修工具店 |
| 屏幕清洁套装 | ¥25-40 | 手机配件店 |
| 热风枪（可选） | ¥80-150 | 五金店/京东 |

## 注意事项
- 偏光膜角度必须准确（GBA为45度）
- 操作环境要无尘，避免灰尘进入
- 加热温度不要过高，避免损坏屏幕
- 如有气泡，可用针轻轻刺破后压平

## 维修难度：★★★★☆
## 预计耗时：2-3小时
"""

    elif keyword == 'PSP电池锁电红灯不亮激活':
        return f"""# {keyword}

> **故障现象**：PSP电池完全无法充电，充电时红灯不亮，电池电量显示为0%，长时间放置后无法开机。

## 所需工具
- 万用表
- 可调电源（0-5V）
- 电烙铁和焊锡
- 杜邦线
- 绝缘胶带
- 电池激活器（可选）

## 维修步骤

### 1. 检测电池状态
1. 用万用表测量电池电压
2. 如果电压低于2.5V，电池已过放
3. 检查电池保护板是否锁死
4. 记录电池正负极位置

### 2. 绕过保护板激活（方法一）
1. 用可调电源设置3.7V电压
2. 将电源正负极直接连接到电芯
3. 充电5-10分钟至电压3.0V以上
4. 断开连接，恢复保护板

### 3. 使用激活器（方法二）
1. 连接电池激活器
2. 选择PSP电池类型
3. 启动激活程序
4. 等待指示灯变绿

### 4. 测试与组装
1. 将电池装回PSP
2. 使用原装充电器充电
3. 观察充电红灯是否亮起
4. 充电30分钟后尝试开机

## 配件与价格参考

| 所需配件 | 参考价格 | 购买建议 |
|---------|---------|---------|
| PSP原装电池 | ¥60-100 | 淘宝/闲鱼 |
| 可调电源模块 | ¥50-80 | 电子市场 |
| 电池激活器 | ¥120-180 | 专业维修店 |
| 万用表（基础款） | ¥40-60 | 五金店/天猫 |

## 注意事项
- 操作时注意正负极，接反会损坏电池
- 激活电压不要超过4.2V
- 激活后电池容量可能下降
- 如多次激活无效，建议更换新电池

## 维修难度：★★★☆☆
## 预计耗时：1-1.5小时
"""

    elif keyword == 'SFC外壳发黄去黄水漂白比例':
        return f"""# {keyword}

> **故障现象**：SFC（超级任天堂）白色塑料外壳因年代久远氧化发黄，颜色不均匀，影响美观，但结构完好无破损。

## 所需工具
- 过氧化氢（双氧水，12%浓度）
- 氧系漂白剂
- UV紫外线灯或太阳光
- 塑料容器
- 刷子
- 塑料薄膜
- 手套和护目镜

## 维修步骤

### 1. 拆卸与清洁
1. 拆卸SFC外壳所有螺丝
2. 分离上下盖和所有部件
3. 用肥皂水彻底清洁外壳
4. 晾干或吹干外壳

### 2. 配制去黄水
1. 过氧化氢（12%）：100ml
2. 氧系漂白剂：20g
3. 温水：50ml
4. 充分搅拌至完全溶解

### 3. 涂抹与反应
1. 将去黄水均匀涂抹在发黄部位
2. 用塑料薄膜包裹外壳
3. 放置在UV灯下或阳光下
4. 反应时间：4-8小时

### 4. 清洗与检查
1. 拆除塑料薄膜
2. 用清水冲洗外壳
3. 检查去黄效果
4. 如需加强，重复步骤3

## 配件与价格参考

| 所需配件 | 参考价格 | 购买建议 |
|---------|---------|---------|
| 过氧化氢（500ml） | ¥25-35 | 药店/化工商店 |
| 氧系漂白剂 | ¥15-25 | 超市/日化店 |
| UV紫外线灯 | ¥80-120 | 淘宝/京东 |
| 塑料容器套装 | ¥20-30 | 家居用品店 |

## 注意事项
- 操作时务必戴手套和护目镜
- 避免去黄水接触金属部件
- 反应时间不宜过长，防止塑料变脆
- 处理后用清水彻底冲洗

## 去黄效果对比
- 轻度发黄：1次处理，恢复80-90%
- 中度发黄：2次处理，恢复70-85%
- 重度发黄：3次处理，恢复60-75%

## 维修难度：★★☆☆☆
## 预计耗时：6-10小时（含反应时间）
"""

    elif keyword == 'NDS转轴断裂更换外壳图文':
        return f"""# {keyword}

> **故障现象**：NDS上盖转轴断裂，屏幕无法固定角度，晃动严重，有时排线因过度弯折出现显示问题。

## 所需工具
- Y字螺丝刀（特殊规格）
- 十字螺丝刀
- 吸盘
- 撬棒套装
- 新外壳（带转轴）
- 电烙铁（如需焊接排线）

## 维修步骤

### 1. 拆卸旧外壳
1. 卸下背部所有Y字螺丝
2. 用吸盘分离触摸屏
3. 小心断开所有排线连接
4. 取出主板和屏幕组件

### 2. 更换转轴部件
1. 将主板安装到新外壳中
2. 对准转轴安装位置
3. 固定转轴螺丝（不要过紧）
4. 测试转轴开合顺畅度

### 3. 安装屏幕组件
1. 将上下屏幕安装到新外壳
2. 连接所有排线（注意方向）
3. 整理排线走向，避免挤压
4. 固定屏幕边框

### 4. 最终测试
1. 暂时不装螺丝，测试开机
2. 检查屏幕显示和触摸功能
3. 测试转轴开合和固定角度
4. 确认无误后安装所有螺丝

## 配件与价格参考

| 所需配件 | 参考价格 | 购买建议 |
|---------|---------|---------|
| NDS原装外壳套装 | ¥45-65 | 淘宝/闲鱼 |
| Y字螺丝刀套装 | ¥25-35 | 维修工具店 |
| 吸盘工具 | ¥10-15 | 手机维修店 |
| 排线（备用） | ¥15-25 | 电子配件店 |

## 注意事项
- NDS排线非常脆弱，操作要轻柔
- 转轴螺丝力度要适中，过紧会卡顿
- 安装前测试所有按钮和接口
- 建议同时更换磨损的按键胶垫

## 常见问题
1. **排线损坏**：更换排线需焊接技巧
2. **转轴不顺畅**：适当调整螺丝松紧
3. **屏幕亮点**：安装时压力不均导致
4. **按键失灵**：清洁或更换按键胶垫

## 维修难度：★★★★☆
## 预计耗时：2-3小时
"""

def main():
    """主函数：生成所有文章"""
    # 确保docs目录存在
    docs_dir = Path("docs")
    docs_dir.mkdir(exist_ok=True)
    
    print("开始生成中古游戏机急救指南文章...")
    print(f"共生成 {len(LONG_TAIL_KEYWORDS)} 篇文章")
    print("-" * 50)
    
    for i, keyword in enumerate(LONG_TAIL_KEYWORDS, 1):
        # 生成文件名（使用拼音或英文，避免中文文件名问题）
        filename_map = {
            'PS2光头老化读盘卡顿修复': 'ps2-lens-repair',
            'GBA屏幕烧屏换偏光膜教程': 'gba-polarizer-replacement',
            'PSP电池锁电红灯不亮激活': 'psp-battery-reactivation',
            'SFC外壳发黄去黄水漂白比例': 'sfc-yellowing-removal',
            'NDS转轴断裂更换外壳图文': 'nds-hinge-replacement'
        }
        
        filename = filename_map.get(keyword, f'article_{i}')
        filepath = docs_dir / f"{filename}.md"
        
        # 生成文章内容
        content = create_article(keyword)
        
        # 写入文件
        with open(filepath, 'w', encoding='utf-8') as f:
            f.write(content)
        
        print(f"{i}. 已生成: {keyword}")
        print(f"   文件: {filepath}")
    
    print("-" * 50)
    print("文章生成完成！")
    print(f"文件保存在: {docs_dir.absolute()}")
    
    # 列出生成的文件
    print("\n生成的文件列表:")
    for file in sorted(docs_dir.glob("*.md")):
        print(f"  - {file.name}")

if __name__ == "__main__":
    main()